<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Reset Password - Daaymn</title>
<link rel="stylesheet" href="../style.css">
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
<div class="container">
  <header>
    <h1>Daaymn!</h1>
    <ul class="nav-tabs">
      <li><a href="../index.html">Home</a></li>
      <li><a href="home.html">App Home</a></li>
      <li><a href="verification.html">Verify</a></li>
      <li><a href="child_safety_policy.html">Child Safety</a></li>
      <li><a href="privacy-policy.html">Privacy Policy</a></li>
      <li><a href="account_deletion.html">Delete Account</a></li>
    </ul>
  </header>

  <main>
    <h2>Reset Your Password</h2>
    <p>Enter your email to receive a password reset link.</p>
    <form id="reset-form">
      <input type="email" id="reset-email" placeholder="Your email" required>
      <button type="submit">Send Reset Link</button>
    </form>
    <div id="reset-message"></div>
  </main>
</div>

<script>
const supabaseUrl = 'https://rrbsjmfwahaerkfhpegv.supabase.co';
const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...';
const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);

document.getElementById('reset-form').addEventListener('submit', async e => {
    e.preventDefault();
    const email = document.getElementById('reset-email').value.trim();
    if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)){
        document.getElementById('reset-message').textContent = "Enter a valid email!";
        return;
    }
    try {
        const { error } = await supabase.auth.resetPasswordForEmail(email, {
            redirectTo: 'https://gawdessey.github.io/Daaymn/docs/verification.html'
        });
        if(error) throw error;
        document.getElementById('reset-message').textContent = "Check your email for the reset link!";
    } catch(err){
        document.getElementById('reset-message').textContent = "Failed to send link.";
    }
});
</script>
</body>
</html>
